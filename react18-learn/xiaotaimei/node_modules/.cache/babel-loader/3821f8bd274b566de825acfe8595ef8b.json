{"ast":null,"code":"import classNames from 'classnames';\nimport React, { useEffect, useState } from 'react';\nimport { MinusOutline, AddOutline } from 'antd-mobile-icons';\nimport { withNativeProps } from '../../utils/native-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { bound } from '../../utils/bound';\nimport Input from '../input';\nimport Button from '../button';\nimport Big from 'big.js';\nimport { useConfig } from '../config-provider';\nconst classPrefix = `adm-stepper`;\nconst defaultProps = {\n  defaultValue: 0,\n  step: 1,\n  disabled: false,\n  allowEmpty: false\n};\nexport const Stepper = p => {\n  const props = mergeProps(defaultProps, p);\n  const {\n    disabled,\n    step,\n    max,\n    min,\n    inputReadOnly\n  } = props;\n  const {\n    locale\n  } = useConfig();\n  const [value, setValue] = usePropsValue(props);\n  const [inputValue, setInputValue] = useState(() => convertValueToText(value, props.digits));\n  function setValueWithCheck(v) {\n    if (isNaN(v)) return;\n    let target = bound(v, props.min, props.max);\n    if (props.digits !== undefined) {\n      target = parseFloat(target.toFixed(props.digits));\n    }\n    setValue(target);\n  }\n  const [hasFocus, setHasFocus] = useState(false);\n  useEffect(() => {\n    if (!hasFocus) {\n      setInputValue(convertValueToText(value, props.digits));\n    }\n  }, [hasFocus]);\n  useEffect(() => {\n    if (!hasFocus) {\n      setInputValue(convertValueToText(value, props.digits));\n    }\n  }, [value, props.digits]);\n  const handleInputChange = v => {\n    setInputValue(v);\n    const value = convertTextToValue(v);\n    if (value === null) {\n      if (props.allowEmpty) {\n        setValue(null);\n      } else {\n        setValue(props.defaultValue);\n      }\n    } else {\n      setValueWithCheck(value);\n    }\n  };\n  const handleMinus = () => {\n    setValueWithCheck(Big(value !== null && value !== void 0 ? value : 0).minus(step).toNumber());\n  };\n  const handlePlus = () => {\n    setValueWithCheck(Big(value !== null && value !== void 0 ? value : 0).add(step).toNumber());\n  };\n  const minusDisabled = () => {\n    if (disabled) return true;\n    if (value === null) return false;\n    if (min !== undefined) {\n      return value <= min;\n    }\n    return false;\n  };\n  const plusDisabled = () => {\n    if (disabled) return true;\n    if (value === null) return false;\n    if (max !== undefined) {\n      return value >= max;\n    }\n    return false;\n  };\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classNames(classPrefix, {\n      [`${classPrefix}-active`]: hasFocus\n    })\n  }, React.createElement(Button, {\n    className: `${classPrefix}-minus`,\n    onClick: handleMinus,\n    disabled: minusDisabled(),\n    fill: 'none',\n    shape: 'rectangular',\n    color: 'primary',\n    \"aria-label\": locale.Stepper.decrease\n  }, React.createElement(MinusOutline, null)), React.createElement(\"div\", {\n    className: `${classPrefix}-middle`\n  }, React.createElement(Input, {\n    className: `${classPrefix}-input`,\n    onFocus: e => {\n      var _a;\n      setHasFocus(true);\n      (_a = props.onFocus) === null || _a === void 0 ? void 0 : _a.call(props, e);\n    },\n    value: inputValue,\n    onChange: val => {\n      disabled || handleInputChange(val);\n    },\n    disabled: disabled,\n    onBlur: e => {\n      var _a;\n      setHasFocus(false);\n      (_a = props.onBlur) === null || _a === void 0 ? void 0 : _a.call(props, e);\n    },\n    readOnly: inputReadOnly,\n    role: 'spinbutton',\n    \"aria-valuenow\": Number(inputValue),\n    \"aria-valuemax\": max,\n    \"aria-valuemin\": min,\n    inputMode: 'decimal'\n  })), React.createElement(Button, {\n    className: `${classPrefix}-plus`,\n    onClick: handlePlus,\n    disabled: plusDisabled(),\n    fill: 'none',\n    shape: 'rectangular',\n    color: 'primary',\n    \"aria-label\": locale.Stepper.increase\n  }, React.createElement(AddOutline, null))));\n};\nfunction convertValueToText(value, digits) {\n  if (value === null) return '';\n  if (digits !== undefined) {\n    return value.toFixed(digits);\n  } else {\n    return value.toString();\n  }\n}\nfunction convertTextToValue(text) {\n  if (text === '') return null;\n  return parseFloat(text);\n}","map":{"version":3,"names":["classNames","React","useEffect","useState","MinusOutline","AddOutline","withNativeProps","usePropsValue","mergeProps","bound","Input","Button","Big","useConfig","classPrefix","defaultProps","defaultValue","step","disabled","allowEmpty","Stepper","p","props","max","min","inputReadOnly","locale","value","setValue","inputValue","setInputValue","convertValueToText","digits","setValueWithCheck","v","isNaN","target","undefined","parseFloat","toFixed","hasFocus","setHasFocus","handleInputChange","convertTextToValue","handleMinus","minus","toNumber","handlePlus","add","minusDisabled","plusDisabled","createElement","className","onClick","fill","shape","color","decrease","onFocus","e","_a","call","onChange","val","onBlur","readOnly","role","Number","inputMode","increase","toString","text"],"sources":["/Users/xinyonghu/Desktop/personalCode/react18-learn/xiaotaimei/node_modules/antd-mobile/es/components/stepper/stepper.js"],"sourcesContent":["import classNames from 'classnames';\nimport React, { useEffect, useState } from 'react';\nimport { MinusOutline, AddOutline } from 'antd-mobile-icons';\nimport { withNativeProps } from '../../utils/native-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { bound } from '../../utils/bound';\nimport Input from '../input';\nimport Button from '../button';\nimport Big from 'big.js';\nimport { useConfig } from '../config-provider';\nconst classPrefix = `adm-stepper`;\nconst defaultProps = {\n  defaultValue: 0,\n  step: 1,\n  disabled: false,\n  allowEmpty: false\n};\nexport const Stepper = p => {\n  const props = mergeProps(defaultProps, p);\n  const {\n    disabled,\n    step,\n    max,\n    min,\n    inputReadOnly\n  } = props;\n  const {\n    locale\n  } = useConfig();\n  const [value, setValue] = usePropsValue(props);\n  const [inputValue, setInputValue] = useState(() => convertValueToText(value, props.digits));\n  function setValueWithCheck(v) {\n    if (isNaN(v)) return;\n    let target = bound(v, props.min, props.max);\n    if (props.digits !== undefined) {\n      target = parseFloat(target.toFixed(props.digits));\n    }\n    setValue(target);\n  }\n  const [hasFocus, setHasFocus] = useState(false);\n  useEffect(() => {\n    if (!hasFocus) {\n      setInputValue(convertValueToText(value, props.digits));\n    }\n  }, [hasFocus]);\n  useEffect(() => {\n    if (!hasFocus) {\n      setInputValue(convertValueToText(value, props.digits));\n    }\n  }, [value, props.digits]);\n  const handleInputChange = v => {\n    setInputValue(v);\n    const value = convertTextToValue(v);\n    if (value === null) {\n      if (props.allowEmpty) {\n        setValue(null);\n      } else {\n        setValue(props.defaultValue);\n      }\n    } else {\n      setValueWithCheck(value);\n    }\n  };\n  const handleMinus = () => {\n    setValueWithCheck(Big(value !== null && value !== void 0 ? value : 0).minus(step).toNumber());\n  };\n  const handlePlus = () => {\n    setValueWithCheck(Big(value !== null && value !== void 0 ? value : 0).add(step).toNumber());\n  };\n  const minusDisabled = () => {\n    if (disabled) return true;\n    if (value === null) return false;\n    if (min !== undefined) {\n      return value <= min;\n    }\n    return false;\n  };\n  const plusDisabled = () => {\n    if (disabled) return true;\n    if (value === null) return false;\n    if (max !== undefined) {\n      return value >= max;\n    }\n    return false;\n  };\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classNames(classPrefix, {\n      [`${classPrefix}-active`]: hasFocus\n    })\n  }, React.createElement(Button, {\n    className: `${classPrefix}-minus`,\n    onClick: handleMinus,\n    disabled: minusDisabled(),\n    fill: 'none',\n    shape: 'rectangular',\n    color: 'primary',\n    \"aria-label\": locale.Stepper.decrease\n  }, React.createElement(MinusOutline, null)), React.createElement(\"div\", {\n    className: `${classPrefix}-middle`\n  }, React.createElement(Input, {\n    className: `${classPrefix}-input`,\n    onFocus: e => {\n      var _a;\n      setHasFocus(true);\n      (_a = props.onFocus) === null || _a === void 0 ? void 0 : _a.call(props, e);\n    },\n    value: inputValue,\n    onChange: val => {\n      disabled || handleInputChange(val);\n    },\n    disabled: disabled,\n    onBlur: e => {\n      var _a;\n      setHasFocus(false);\n      (_a = props.onBlur) === null || _a === void 0 ? void 0 : _a.call(props, e);\n    },\n    readOnly: inputReadOnly,\n    role: 'spinbutton',\n    \"aria-valuenow\": Number(inputValue),\n    \"aria-valuemax\": max,\n    \"aria-valuemin\": min,\n    inputMode: 'decimal'\n  })), React.createElement(Button, {\n    className: `${classPrefix}-plus`,\n    onClick: handlePlus,\n    disabled: plusDisabled(),\n    fill: 'none',\n    shape: 'rectangular',\n    color: 'primary',\n    \"aria-label\": locale.Stepper.increase\n  }, React.createElement(AddOutline, null))));\n};\nfunction convertValueToText(value, digits) {\n  if (value === null) return '';\n  if (digits !== undefined) {\n    return value.toFixed(digits);\n  } else {\n    return value.toString();\n  }\n}\nfunction convertTextToValue(text) {\n  if (text === '') return null;\n  return parseFloat(text);\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}