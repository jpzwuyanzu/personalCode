{"ast":null,"code":"import React, { useRef } from 'react';\nimport { withNativeProps } from '../../utils/native-props';\nimport List from '../list';\nimport { DownOutline } from 'antd-mobile-icons';\nimport classNames from 'classnames';\nimport { useSpring, animated } from '@react-spring/web';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport { useMount } from 'ahooks';\nimport { useShouldRender } from '../../utils/should-render';\nimport { useIsomorphicUpdateLayoutEffect } from '../../utils/use-isomorphic-update-layout-effect';\nimport { traverseReactNode } from '../../utils/traverse-react-node';\nconst classPrefix = `adm-collapse`;\nexport const CollapsePanel = () => {\n  return null;\n};\nconst CollapsePanelContent = props => {\n  const {\n    visible\n  } = props;\n  const innerRef = useRef(null);\n  const shouldRender = useShouldRender(visible, props.forceRender, props.destroyOnClose);\n  const [{\n    height\n  }, api] = useSpring(() => ({\n    from: {\n      height: 0\n    },\n    config: {\n      precision: 0.01,\n      mass: 1,\n      tension: 200,\n      friction: 25,\n      clamp: true\n    }\n  }));\n  useMount(() => {\n    if (!visible) return;\n    const inner = innerRef.current;\n    if (!inner) return;\n    api.start({\n      height: inner.offsetHeight,\n      immediate: true\n    });\n  });\n  useIsomorphicUpdateLayoutEffect(() => {\n    const inner = innerRef.current;\n    if (!inner) return;\n    if (visible) {\n      api.start({\n        height: inner.offsetHeight\n      });\n    } else {\n      api.start({\n        height: inner.offsetHeight,\n        immediate: true\n      });\n      api.start({\n        height: 0\n      });\n    }\n  }, [visible]);\n  return React.createElement(animated.div, {\n    className: `${classPrefix}-panel-content`,\n    style: {\n      height: height.to(v => {\n        if (height.idle && visible) {\n          return 'auto';\n        } else {\n          return v;\n        }\n      })\n    }\n  }, React.createElement(\"div\", {\n    className: `${classPrefix}-panel-content-inner`,\n    ref: innerRef\n  }, React.createElement(List.Item, null, shouldRender && props.children)));\n};\nexport const Collapse = props => {\n  var _a;\n  const panels = [];\n  traverseReactNode(props.children, child => {\n    if (!React.isValidElement(child)) return;\n    const key = child.key;\n    if (typeof key !== 'string') return;\n    panels.push(child);\n  });\n  const [activeKey, setActiveKey] = usePropsValue(props.accordion ? {\n    value: props.activeKey === undefined ? undefined : props.activeKey === null ? [] : [props.activeKey],\n    defaultValue: props.defaultActiveKey === undefined || props.defaultActiveKey === null ? [] : [props.defaultActiveKey],\n    onChange: v => {\n      var _a, _b;\n      (_a = props.onChange) === null || _a === void 0 ? void 0 : _a.call(props, (_b = v[0]) !== null && _b !== void 0 ? _b : null);\n    }\n  } : {\n    value: props.activeKey,\n    defaultValue: (_a = props.defaultActiveKey) !== null && _a !== void 0 ? _a : [],\n    onChange: props.onChange\n  });\n  const activeKeyList = activeKey === null ? [] : Array.isArray(activeKey) ? activeKey : [activeKey];\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classPrefix\n  }, React.createElement(List, null, panels.map(panel => {\n    const key = panel.key;\n    const active = activeKeyList.includes(key);\n    function handleClick(event) {\n      var _a, _b;\n      if (props.accordion) {\n        if (active) {\n          setActiveKey([]);\n        } else {\n          setActiveKey([key]);\n        }\n      } else {\n        if (active) {\n          setActiveKey(activeKeyList.filter(v => v !== key));\n        } else {\n          setActiveKey([...activeKeyList, key]);\n        }\n      }\n      (_b = (_a = panel.props).onClick) === null || _b === void 0 ? void 0 : _b.call(_a, event);\n    }\n    const renderArrow = () => {\n      let arrow = React.createElement(DownOutline, null);\n      if (props.arrow !== undefined) {\n        arrow = props.arrow;\n      }\n      if (panel.props.arrow !== undefined) {\n        arrow = panel.props.arrow;\n      }\n      return typeof arrow === 'function' ? arrow(active) : React.createElement(\"div\", {\n        className: classNames(`${classPrefix}-arrow`, {\n          [`${classPrefix}-arrow-active`]: active\n        })\n      }, arrow);\n    };\n    return React.createElement(React.Fragment, {\n      key: key\n    }, withNativeProps(panel.props, React.createElement(List.Item, {\n      className: `${classPrefix}-panel-header`,\n      onClick: handleClick,\n      disabled: panel.props.disabled,\n      arrow: renderArrow()\n    }, panel.props.title)), React.createElement(CollapsePanelContent, {\n      visible: active,\n      forceRender: !!panel.props.forceRender,\n      destroyOnClose: !!panel.props.destroyOnClose\n    }, panel.props.children));\n  }))));\n};","map":{"version":3,"names":["React","useRef","withNativeProps","List","DownOutline","classNames","useSpring","animated","usePropsValue","useMount","useShouldRender","useIsomorphicUpdateLayoutEffect","traverseReactNode","classPrefix","CollapsePanel","CollapsePanelContent","props","visible","innerRef","shouldRender","forceRender","destroyOnClose","height","api","from","config","precision","mass","tension","friction","clamp","inner","current","start","offsetHeight","immediate","createElement","div","className","style","to","v","idle","ref","Item","children","Collapse","_a","panels","child","isValidElement","key","push","activeKey","setActiveKey","accordion","value","undefined","defaultValue","defaultActiveKey","onChange","_b","call","activeKeyList","Array","isArray","map","panel","active","includes","handleClick","event","filter","onClick","renderArrow","arrow","Fragment","disabled","title"],"sources":["/Users/xinyonghu/Desktop/personalCode/react18-learn/xiaotaimei/node_modules/antd-mobile/es/components/collapse/collapse.js"],"sourcesContent":["import React, { useRef } from 'react';\nimport { withNativeProps } from '../../utils/native-props';\nimport List from '../list';\nimport { DownOutline } from 'antd-mobile-icons';\nimport classNames from 'classnames';\nimport { useSpring, animated } from '@react-spring/web';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport { useMount } from 'ahooks';\nimport { useShouldRender } from '../../utils/should-render';\nimport { useIsomorphicUpdateLayoutEffect } from '../../utils/use-isomorphic-update-layout-effect';\nimport { traverseReactNode } from '../../utils/traverse-react-node';\nconst classPrefix = `adm-collapse`;\nexport const CollapsePanel = () => {\n  return null;\n};\nconst CollapsePanelContent = props => {\n  const {\n    visible\n  } = props;\n  const innerRef = useRef(null);\n  const shouldRender = useShouldRender(visible, props.forceRender, props.destroyOnClose);\n  const [{\n    height\n  }, api] = useSpring(() => ({\n    from: {\n      height: 0\n    },\n    config: {\n      precision: 0.01,\n      mass: 1,\n      tension: 200,\n      friction: 25,\n      clamp: true\n    }\n  }));\n  useMount(() => {\n    if (!visible) return;\n    const inner = innerRef.current;\n    if (!inner) return;\n    api.start({\n      height: inner.offsetHeight,\n      immediate: true\n    });\n  });\n  useIsomorphicUpdateLayoutEffect(() => {\n    const inner = innerRef.current;\n    if (!inner) return;\n    if (visible) {\n      api.start({\n        height: inner.offsetHeight\n      });\n    } else {\n      api.start({\n        height: inner.offsetHeight,\n        immediate: true\n      });\n      api.start({\n        height: 0\n      });\n    }\n  }, [visible]);\n  return React.createElement(animated.div, {\n    className: `${classPrefix}-panel-content`,\n    style: {\n      height: height.to(v => {\n        if (height.idle && visible) {\n          return 'auto';\n        } else {\n          return v;\n        }\n      })\n    }\n  }, React.createElement(\"div\", {\n    className: `${classPrefix}-panel-content-inner`,\n    ref: innerRef\n  }, React.createElement(List.Item, null, shouldRender && props.children)));\n};\nexport const Collapse = props => {\n  var _a;\n  const panels = [];\n  traverseReactNode(props.children, child => {\n    if (!React.isValidElement(child)) return;\n    const key = child.key;\n    if (typeof key !== 'string') return;\n    panels.push(child);\n  });\n  const [activeKey, setActiveKey] = usePropsValue(props.accordion ? {\n    value: props.activeKey === undefined ? undefined : props.activeKey === null ? [] : [props.activeKey],\n    defaultValue: props.defaultActiveKey === undefined || props.defaultActiveKey === null ? [] : [props.defaultActiveKey],\n    onChange: v => {\n      var _a, _b;\n      (_a = props.onChange) === null || _a === void 0 ? void 0 : _a.call(props, (_b = v[0]) !== null && _b !== void 0 ? _b : null);\n    }\n  } : {\n    value: props.activeKey,\n    defaultValue: (_a = props.defaultActiveKey) !== null && _a !== void 0 ? _a : [],\n    onChange: props.onChange\n  });\n  const activeKeyList = activeKey === null ? [] : Array.isArray(activeKey) ? activeKey : [activeKey];\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classPrefix\n  }, React.createElement(List, null, panels.map(panel => {\n    const key = panel.key;\n    const active = activeKeyList.includes(key);\n    function handleClick(event) {\n      var _a, _b;\n      if (props.accordion) {\n        if (active) {\n          setActiveKey([]);\n        } else {\n          setActiveKey([key]);\n        }\n      } else {\n        if (active) {\n          setActiveKey(activeKeyList.filter(v => v !== key));\n        } else {\n          setActiveKey([...activeKeyList, key]);\n        }\n      }\n      (_b = (_a = panel.props).onClick) === null || _b === void 0 ? void 0 : _b.call(_a, event);\n    }\n    const renderArrow = () => {\n      let arrow = React.createElement(DownOutline, null);\n      if (props.arrow !== undefined) {\n        arrow = props.arrow;\n      }\n      if (panel.props.arrow !== undefined) {\n        arrow = panel.props.arrow;\n      }\n      return typeof arrow === 'function' ? arrow(active) : React.createElement(\"div\", {\n        className: classNames(`${classPrefix}-arrow`, {\n          [`${classPrefix}-arrow-active`]: active\n        })\n      }, arrow);\n    };\n    return React.createElement(React.Fragment, {\n      key: key\n    }, withNativeProps(panel.props, React.createElement(List.Item, {\n      className: `${classPrefix}-panel-header`,\n      onClick: handleClick,\n      disabled: panel.props.disabled,\n      arrow: renderArrow()\n    }, panel.props.title)), React.createElement(CollapsePanelContent, {\n      visible: active,\n      forceRender: !!panel.props.forceRender,\n      destroyOnClose: !!panel.props.destroyOnClose\n    }, panel.props.children));\n  }))));\n};"],"mappings":"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"},"metadata":{},"sourceType":"module"}