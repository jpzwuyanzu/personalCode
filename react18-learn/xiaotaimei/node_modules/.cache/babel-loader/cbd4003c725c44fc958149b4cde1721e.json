{"ast":null,"code":"var __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n    r,\n    ar = [],\n    e;\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n  return ar;\n};\nimport dayjs from 'dayjs';\nimport { useEffect, useMemo, useState } from 'react';\nimport useLatest from '../useLatest';\nimport { isNumber } from '../utils/index';\nvar calcLeft = function calcLeft(target) {\n  if (!target) {\n    return 0;\n  }\n  // https://stackoverflow.com/questions/4310953/invalid-date-in-safari\n  var left = dayjs(target).valueOf() - Date.now();\n  return left < 0 ? 0 : left;\n};\nvar parseMs = function parseMs(milliseconds) {\n  return {\n    days: Math.floor(milliseconds / 86400000),\n    hours: Math.floor(milliseconds / 3600000) % 24,\n    minutes: Math.floor(milliseconds / 60000) % 60,\n    seconds: Math.floor(milliseconds / 1000) % 60,\n    milliseconds: Math.floor(milliseconds) % 1000\n  };\n};\nvar useCountdown = function useCountdown(options) {\n  if (options === void 0) {\n    options = {};\n  }\n  var _a = options || {},\n    leftTime = _a.leftTime,\n    targetDate = _a.targetDate,\n    _b = _a.interval,\n    interval = _b === void 0 ? 1000 : _b,\n    onEnd = _a.onEnd;\n  var target = useMemo(function () {\n    if ('leftTime' in options) {\n      return isNumber(leftTime) && leftTime > 0 ? Date.now() + leftTime : undefined;\n    } else {\n      return targetDate;\n    }\n  }, [leftTime, targetDate]);\n  var _c = __read(useState(function () {\n      return calcLeft(target);\n    }), 2),\n    timeLeft = _c[0],\n    setTimeLeft = _c[1];\n  var onEndRef = useLatest(onEnd);\n  useEffect(function () {\n    if (!target) {\n      // for stop\n      setTimeLeft(0);\n      return;\n    }\n    // 立即执行一次\n    setTimeLeft(calcLeft(target));\n    var timer = setInterval(function () {\n      var _a;\n      var targetLeft = calcLeft(target);\n      setTimeLeft(targetLeft);\n      if (targetLeft === 0) {\n        clearInterval(timer);\n        (_a = onEndRef.current) === null || _a === void 0 ? void 0 : _a.call(onEndRef);\n      }\n    }, interval);\n    return function () {\n      return clearInterval(timer);\n    };\n  }, [target, interval]);\n  var formattedRes = useMemo(function () {\n    return parseMs(timeLeft);\n  }, [timeLeft]);\n  return [timeLeft, formattedRes];\n};\nexport default useCountdown;","map":{"version":3,"names":["__read","o","n","m","Symbol","iterator","i","call","r","ar","e","next","done","push","value","error","dayjs","useEffect","useMemo","useState","useLatest","isNumber","calcLeft","target","left","valueOf","Date","now","parseMs","milliseconds","days","Math","floor","hours","minutes","seconds","useCountdown","options","_a","leftTime","targetDate","_b","interval","onEnd","undefined","_c","timeLeft","setTimeLeft","onEndRef","timer","setInterval","targetLeft","clearInterval","current","formattedRes"],"sources":["/Users/xinyonghu/Desktop/personalCode/react18-learn/xiaotaimei/node_modules/ahooks/es/useCountDown/index.js"],"sourcesContent":["var __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n    r,\n    ar = [],\n    e;\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n  return ar;\n};\nimport dayjs from 'dayjs';\nimport { useEffect, useMemo, useState } from 'react';\nimport useLatest from '../useLatest';\nimport { isNumber } from '../utils/index';\nvar calcLeft = function calcLeft(target) {\n  if (!target) {\n    return 0;\n  }\n  // https://stackoverflow.com/questions/4310953/invalid-date-in-safari\n  var left = dayjs(target).valueOf() - Date.now();\n  return left < 0 ? 0 : left;\n};\nvar parseMs = function parseMs(milliseconds) {\n  return {\n    days: Math.floor(milliseconds / 86400000),\n    hours: Math.floor(milliseconds / 3600000) % 24,\n    minutes: Math.floor(milliseconds / 60000) % 60,\n    seconds: Math.floor(milliseconds / 1000) % 60,\n    milliseconds: Math.floor(milliseconds) % 1000\n  };\n};\nvar useCountdown = function useCountdown(options) {\n  if (options === void 0) {\n    options = {};\n  }\n  var _a = options || {},\n    leftTime = _a.leftTime,\n    targetDate = _a.targetDate,\n    _b = _a.interval,\n    interval = _b === void 0 ? 1000 : _b,\n    onEnd = _a.onEnd;\n  var target = useMemo(function () {\n    if ('leftTime' in options) {\n      return isNumber(leftTime) && leftTime > 0 ? Date.now() + leftTime : undefined;\n    } else {\n      return targetDate;\n    }\n  }, [leftTime, targetDate]);\n  var _c = __read(useState(function () {\n      return calcLeft(target);\n    }), 2),\n    timeLeft = _c[0],\n    setTimeLeft = _c[1];\n  var onEndRef = useLatest(onEnd);\n  useEffect(function () {\n    if (!target) {\n      // for stop\n      setTimeLeft(0);\n      return;\n    }\n    // 立即执行一次\n    setTimeLeft(calcLeft(target));\n    var timer = setInterval(function () {\n      var _a;\n      var targetLeft = calcLeft(target);\n      setTimeLeft(targetLeft);\n      if (targetLeft === 0) {\n        clearInterval(timer);\n        (_a = onEndRef.current) === null || _a === void 0 ? void 0 : _a.call(onEndRef);\n      }\n    }, interval);\n    return function () {\n      return clearInterval(timer);\n    };\n  }, [target, interval]);\n  var formattedRes = useMemo(function () {\n    return parseMs(timeLeft);\n  }, [timeLeft]);\n  return [timeLeft, formattedRes];\n};\nexport default useCountdown;"],"mappings":"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"},"metadata":{},"sourceType":"module"}