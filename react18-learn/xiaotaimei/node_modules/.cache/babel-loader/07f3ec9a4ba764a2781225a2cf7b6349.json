{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n    r,\n    ar = [],\n    e;\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n  return ar;\n};\nimport { useRef, useState } from 'react';\nimport { getTargetElement } from '../utils/domTarget';\nimport useEffectWithTarget from '../utils/useEffectWithTarget';\nvar initRect = {\n  top: NaN,\n  left: NaN,\n  bottom: NaN,\n  right: NaN,\n  height: NaN,\n  width: NaN\n};\nvar initState = __assign({\n  text: ''\n}, initRect);\nfunction getRectFromSelection(selection) {\n  if (!selection) {\n    return initRect;\n  }\n  if (selection.rangeCount < 1) {\n    return initRect;\n  }\n  var range = selection.getRangeAt(0);\n  var _a = range.getBoundingClientRect(),\n    height = _a.height,\n    width = _a.width,\n    top = _a.top,\n    left = _a.left,\n    right = _a.right,\n    bottom = _a.bottom;\n  return {\n    height: height,\n    width: width,\n    top: top,\n    left: left,\n    right: right,\n    bottom: bottom\n  };\n}\nfunction useTextSelection(target) {\n  var _a = __read(useState(initState), 2),\n    state = _a[0],\n    setState = _a[1];\n  var stateRef = useRef(state);\n  stateRef.current = state;\n  useEffectWithTarget(function () {\n    var el = getTargetElement(target, document);\n    if (!el) {\n      return;\n    }\n    var mouseupHandler = function mouseupHandler() {\n      var selObj = null;\n      var text = '';\n      var rect = initRect;\n      if (!window.getSelection) return;\n      selObj = window.getSelection();\n      text = selObj ? selObj.toString() : '';\n      if (text) {\n        rect = getRectFromSelection(selObj);\n        setState(__assign(__assign(__assign({}, state), {\n          text: text\n        }), rect));\n      }\n    };\n    // 任意点击都需要清空之前的 range\n    var mousedownHandler = function mousedownHandler() {\n      if (!window.getSelection) return;\n      if (stateRef.current.text) {\n        setState(__assign({}, initState));\n      }\n      var selObj = window.getSelection();\n      if (!selObj) return;\n      selObj.removeAllRanges();\n    };\n    el.addEventListener('mouseup', mouseupHandler);\n    document.addEventListener('mousedown', mousedownHandler);\n    return function () {\n      el.removeEventListener('mouseup', mouseupHandler);\n      document.removeEventListener('mousedown', mousedownHandler);\n    };\n  }, [], target);\n  return state;\n}\nexport default useTextSelection;","map":{"version":3,"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__read","o","m","Symbol","iterator","r","ar","e","next","done","push","value","error","useRef","useState","getTargetElement","useEffectWithTarget","initRect","top","NaN","left","bottom","right","height","width","initState","text","getRectFromSelection","selection","rangeCount","range","getRangeAt","_a","getBoundingClientRect","useTextSelection","target","state","setState","stateRef","current","el","document","mouseupHandler","selObj","rect","window","getSelection","toString","mousedownHandler","removeAllRanges","addEventListener","removeEventListener"],"sources":["/Users/xinyonghu/Desktop/personalCode/react18-learn/xiaotaimei/node_modules/ahooks/es/useTextSelection/index.js"],"sourcesContent":["var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n    r,\n    ar = [],\n    e;\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n  return ar;\n};\nimport { useRef, useState } from 'react';\nimport { getTargetElement } from '../utils/domTarget';\nimport useEffectWithTarget from '../utils/useEffectWithTarget';\nvar initRect = {\n  top: NaN,\n  left: NaN,\n  bottom: NaN,\n  right: NaN,\n  height: NaN,\n  width: NaN\n};\nvar initState = __assign({\n  text: ''\n}, initRect);\nfunction getRectFromSelection(selection) {\n  if (!selection) {\n    return initRect;\n  }\n  if (selection.rangeCount < 1) {\n    return initRect;\n  }\n  var range = selection.getRangeAt(0);\n  var _a = range.getBoundingClientRect(),\n    height = _a.height,\n    width = _a.width,\n    top = _a.top,\n    left = _a.left,\n    right = _a.right,\n    bottom = _a.bottom;\n  return {\n    height: height,\n    width: width,\n    top: top,\n    left: left,\n    right: right,\n    bottom: bottom\n  };\n}\nfunction useTextSelection(target) {\n  var _a = __read(useState(initState), 2),\n    state = _a[0],\n    setState = _a[1];\n  var stateRef = useRef(state);\n  stateRef.current = state;\n  useEffectWithTarget(function () {\n    var el = getTargetElement(target, document);\n    if (!el) {\n      return;\n    }\n    var mouseupHandler = function mouseupHandler() {\n      var selObj = null;\n      var text = '';\n      var rect = initRect;\n      if (!window.getSelection) return;\n      selObj = window.getSelection();\n      text = selObj ? selObj.toString() : '';\n      if (text) {\n        rect = getRectFromSelection(selObj);\n        setState(__assign(__assign(__assign({}, state), {\n          text: text\n        }), rect));\n      }\n    };\n    // 任意点击都需要清空之前的 range\n    var mousedownHandler = function mousedownHandler() {\n      if (!window.getSelection) return;\n      if (stateRef.current.text) {\n        setState(__assign({}, initState));\n      }\n      var selObj = window.getSelection();\n      if (!selObj) return;\n      selObj.removeAllRanges();\n    };\n    el.addEventListener('mouseup', mouseupHandler);\n    document.addEventListener('mousedown', mousedownHandler);\n    return function () {\n      el.removeEventListener('mouseup', mouseupHandler);\n      document.removeEventListener('mousedown', mousedownHandler);\n    };\n  }, [], target);\n  return state;\n}\nexport default useTextSelection;"],"mappings":"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"},"metadata":{},"sourceType":"module"}